(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    112559,       3029]
NotebookOptionsPosition[    109207,       2930]
NotebookOutlinePosition[    109541,       2945]
CellTagsIndexPosition[    109498,       2942]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Unprotect", "[", 
   RowBox[{"In", ",", "Out"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"In", ",", "Out"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"General", "::", "spell1"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.670310404527686*^9, 3.6703104058256693`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"coords", "=", 
   RowBox[{"{", 
    RowBox[{"t", ",", "r", ",", "\[Theta]", ",", "\[Phi]"}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.673076929453498*^9, 3.6730769299118443`*^9}}],

Cell["Just as with the analytical case, we define the metric.", "Text",
 CellChangeTimes->{{3.6735976616212873`*^9, 3.673597669772077*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"gdd", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"g00", ",", "0", ",", "0", ",", "g03"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "g11", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "g22", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"g03", ",", "0", ",", "0", ",", "g33"}], "}"}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "gdd", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g00", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", 
          RowBox[{"f0", "[", 
           RowBox[{"r", ",", "\[Theta]"}], "]"}]}]]}], " ", 
       FractionBox[
        SuperscriptBox["r", "2"], 
        RowBox[{"g", "[", "r", "]"}]], 
       RowBox[{"H", "[", "r", "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", 
         RowBox[{"f2", "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}]}]], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], 
       RowBox[{"g", "[", "r", "]"}], 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox[
          RowBox[{"W", "[", 
           RowBox[{"r", ",", "\[Theta]"}], "]"}], 
          RowBox[{"g", "[", "r", "]"}]], ")"}], "2"]}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"g03", "=", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", 
         RowBox[{"f2", "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}]}]]}], 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], 
      RowBox[{"W", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"g11", "=", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", 
        RowBox[{"f1", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}]}]], "/", 
      RowBox[{"H", "[", "r", "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"g22", "=", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", 
        RowBox[{"f1", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}]}]], 
      RowBox[{"g", "[", "r", "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"g33", "=", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", 
        RowBox[{"f2", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}]}]], " ", 
      RowBox[{"g", "[", "r", "]"}], 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}], ";", 
    RowBox[{"MatrixForm", "[", "gdd", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6730766975313463`*^9, 3.673076815959021*^9}, {
  3.67307719342537*^9, 3.673077229165165*^9}, {3.673077281115959*^9, 
  3.673077307024201*^9}, {3.673593643997836*^9, 3.6735936448524446`*^9}, {
  3.6735937429564257`*^9, 3.673593744422048*^9}, {3.673593795842998*^9, 
  3.673593800361662*^9}, {3.6735954170713663`*^9, 3.673595435803232*^9}, {
  3.673595514732771*^9, 3.6735955640811872`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"g00", "0", "0", "g03"},
     {"0", "g11", "0", "0"},
     {"0", "0", "g22", "0"},
     {"g03", "0", "0", "g33"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.673076740126525*^9, {3.673076781972659*^9, 3.673076784610538*^9}, {
   3.6730768163542137`*^9, 3.673076818925905*^9}, {3.673077383810052*^9, 
   3.6730773874339542`*^9}, 3.673082306909595*^9, 3.673082570750544*^9, 
   3.6730826684006357`*^9, 3.6730827286557827`*^9, 3.673082766950859*^9, 
   3.673083017480542*^9, 3.6730833831206617`*^9, 3.673083549705571*^9, 
   3.673084110072126*^9, {3.673084306676076*^9, 3.673084332925303*^9}, 
   3.673084486204733*^9, 3.673086634896249*^9, 3.6731703902101107`*^9, 
   3.673171620884399*^9, 3.6731856061735163`*^9, 3.67318582509618*^9, 
   3.673185995016286*^9, 3.6731866574641943`*^9, 3.6731883789001637`*^9, 
   3.673508268943574*^9, {3.673508947046143*^9, 3.673508969123868*^9}, 
   3.673509213622202*^9, 3.673510027868765*^9, 3.673510991868951*^9, 
   3.673511553424388*^9, 3.673511961379404*^9, 3.673512425349555*^9, 
   3.673512952117086*^9, 3.673513956228271*^9, 3.673515082521729*^9, 
   3.673516736756715*^9, 3.67359251232038*^9, 3.6735936562083883`*^9, 
   3.673593751599127*^9, {3.673593801187442*^9, 3.673593812911099*^9}, 
   3.673594996813624*^9, 3.673595580093725*^9, 3.673596360904731*^9, 
   3.673602575278965*^9, 3.6736101971272373`*^9, 3.673614242337488*^9, 
   3.673615247295556*^9, 3.673617820557674*^9, 3.6736184543672132`*^9, 
   3.673618589716281*^9, 3.673619755985485*^9, 3.6736296640777884`*^9, 
   3.673762987018034*^9, 3.67376359225664*^9, 3.673763808835477*^9, 
   3.67376649028799*^9, 3.673767104989592*^9, 3.673769782498103*^9, 
   3.6742089568266077`*^9, 3.674209114290111*^9, 3.6742097479726963`*^9, {
   3.674209801482892*^9, 3.674209816842949*^9}, {3.67420998196747*^9, 
   3.674210010534101*^9}, 3.6742117462499733`*^9, 3.6742118776566267`*^9, 
   3.674281464539105*^9, 3.674281510682695*^9, 3.6744609825727167`*^9, 
   3.674469403587982*^9, 3.6744705131615887`*^9, 3.6744708725564337`*^9, 
   3.6744718481893682`*^9, 3.6744720507299843`*^9, 3.67447250593893*^9, 
   3.674473674994865*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", 
            RowBox[{"f0", "[", 
             RowBox[{"r", ",", "\[Theta]"}], "]"}]}]], " ", 
          SuperscriptBox["r", "2"], " ", 
          RowBox[{"H", "[", "r", "]"}]}], 
         RowBox[{"g", "[", "r", "]"}]]}], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"2", " ", 
           RowBox[{"f2", "[", 
            RowBox[{"r", ",", "\[Theta]"}], "]"}]}]], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"W", "[", 
           RowBox[{"r", ",", "\[Theta]"}], "]"}], "2"]}], 
        RowBox[{"g", "[", "r", "]"}]]}], "0", "0", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", 
          RowBox[{"f2", "[", 
           RowBox[{"r", ",", "\[Theta]"}], "]"}]}]]}], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
       RowBox[{"W", "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}]}]},
     {"0", 
      FractionBox[
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", 
         RowBox[{"f1", "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}]}]], 
       RowBox[{"H", "[", "r", "]"}]], "0", "0"},
     {"0", "0", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", 
         RowBox[{"f1", "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}]}]], " ", 
       RowBox[{"g", "[", "r", "]"}]}], "0"},
     {
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"2", " ", 
          RowBox[{"f2", "[", 
           RowBox[{"r", ",", "\[Theta]"}], "]"}]}]]}], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"], " ", 
       RowBox[{"W", "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}]}], "0", "0", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"2", " ", 
         RowBox[{"f2", "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}]}]], " ", 
       RowBox[{"g", "[", "r", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.673076740126525*^9, {3.673076781972659*^9, 3.673076784610538*^9}, {
   3.6730768163542137`*^9, 3.673076818925905*^9}, {3.673077383810052*^9, 
   3.6730773874339542`*^9}, 3.673082306909595*^9, 3.673082570750544*^9, 
   3.6730826684006357`*^9, 3.6730827286557827`*^9, 3.673082766950859*^9, 
   3.673083017480542*^9, 3.6730833831206617`*^9, 3.673083549705571*^9, 
   3.673084110072126*^9, {3.673084306676076*^9, 3.673084332925303*^9}, 
   3.673084486204733*^9, 3.673086634896249*^9, 3.6731703902101107`*^9, 
   3.673171620884399*^9, 3.6731856061735163`*^9, 3.67318582509618*^9, 
   3.673185995016286*^9, 3.6731866574641943`*^9, 3.6731883789001637`*^9, 
   3.673508268943574*^9, {3.673508947046143*^9, 3.673508969123868*^9}, 
   3.673509213622202*^9, 3.673510027868765*^9, 3.673510991868951*^9, 
   3.673511553424388*^9, 3.673511961379404*^9, 3.673512425349555*^9, 
   3.673512952117086*^9, 3.673513956228271*^9, 3.673515082521729*^9, 
   3.673516736756715*^9, 3.67359251232038*^9, 3.6735936562083883`*^9, 
   3.673593751599127*^9, {3.673593801187442*^9, 3.673593812911099*^9}, 
   3.673594996813624*^9, 3.673595580093725*^9, 3.673596360904731*^9, 
   3.673602575278965*^9, 3.6736101971272373`*^9, 3.673614242337488*^9, 
   3.673615247295556*^9, 3.673617820557674*^9, 3.6736184543672132`*^9, 
   3.673618589716281*^9, 3.673619755985485*^9, 3.6736296640777884`*^9, 
   3.673762987018034*^9, 3.67376359225664*^9, 3.673763808835477*^9, 
   3.67376649028799*^9, 3.673767104989592*^9, 3.673769782498103*^9, 
   3.6742089568266077`*^9, 3.674209114290111*^9, 3.6742097479726963`*^9, {
   3.674209801482892*^9, 3.674209816842949*^9}, {3.67420998196747*^9, 
   3.674210010534101*^9}, 3.6742117462499733`*^9, 3.6742118776566267`*^9, 
   3.674281464539105*^9, 3.674281510682695*^9, 3.6744609825727167`*^9, 
   3.674469403587982*^9, 3.6744705131615887`*^9, 3.6744708725564337`*^9, 
   3.6744718481893682`*^9, 3.6744720507299843`*^9, 3.67447250593893*^9, 
   3.674473675024063*^9}]
}, Open  ]],

Cell["Its inverse and determinant", "Text",
 CellChangeTimes->{{3.673597674688163*^9, 3.6735976786800203`*^9}, {
  3.6736152480730677`*^9, 3.673615249515616*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"guu", "=", 
   RowBox[{"Inverse", "[", "gdd", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dim", "=", 
   RowBox[{"Length", "[", "gdd", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.673076820666408*^9, 3.6730768322811337`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"g", "[", 
       RowBox[{"i", ",", "j"}], "]"}], "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"gdd", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ";"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "dim"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "dim"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"gu", "[", 
       RowBox[{"i", ",", "j"}], "]"}], "=", 
      RowBox[{"Simplify", "[", 
       RowBox[{"guu", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}]}], ";"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "dim"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "dim"}], "}"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.67307684045319*^9, 3.6730768538801813`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DET", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Det", "[", "gdd", "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.673076842011074*^9, 3.673076859189123*^9}}],

Cell["The tetrad is the same in terms of the metric elements", "Text",
 CellChangeTimes->{{3.673597681422563*^9, 3.673597699521963*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"euu", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"e00", ",", "0", ",", "0", ",", "e03"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "e11", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "e22", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"e30", ",", "0", ",", "0", ",", "e33"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.673076863947301*^9, 3.6730768722322083`*^9}, {
  3.674208873104727*^9, 3.674208873432749*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"we", "=", "0"}], ";"}], "*)"}], 
  RowBox[{"(*", 
   RowBox[{"Static", " ", "observer"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"we", "=", 
     RowBox[{
      RowBox[{"-", "g03"}], "/", "g33"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"Zero", " ", "angular", " ", "momentum", " ", "observer"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"we", "=", 
      RowBox[{"a", "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "^", "2"}], "+", 
         RowBox[{"a", "^", "2"}]}], ")"}]}]}], ";"}], "*)"}], 
   RowBox[{"(*", 
    RowBox[{"Carter", " ", "observer"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"we", "=", 
     RowBox[{
      RowBox[{"Sqrt", "[", "M", "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r", "^", 
         RowBox[{"(", 
          RowBox[{"3", "/", "2"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Sqrt", "[", "M", "]"}], "a"}]}], ")"}]}]}], "*)"}], 
   RowBox[{"(*", 
    RowBox[{"Freely", " ", "orbiting", " ", "stationary", " ", "observer"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ut", "=", 
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"-", "g00"}], "-", 
        RowBox[{"2", " ", "g03", " ", "we"}], "-", 
        RowBox[{"g33", " ", 
         RowBox[{"we", "^", "2"}]}]}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"e00", "=", "ut"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"e03", "=", 
     RowBox[{"ut", " ", "we"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"e11", "=", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"gu", "[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"e22", "=", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"gu", "[", 
       RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"e30", "=", 
     RowBox[{"-", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"ut", "^", "2"}], "+", 
        RowBox[{"gu", "[", 
         RowBox[{"1", ",", "1"}], "]"}]}], "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"e33", "=", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ut", "^", "2"}], " ", 
        RowBox[{"we", "^", "2"}]}], "+", 
       RowBox[{"gu", "[", 
        RowBox[{"4", ",", "4"}], "]"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"edd", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Inverse", "[", "euu", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Csc", "[", "\[Theta]", "]"}], ">", "0"}], "&&", 
        RowBox[{"r", ">", "0"}], "&&", 
        RowBox[{
         RowBox[{"f2", "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}], ">", "0"}], "&&", 
        RowBox[{
         RowBox[{"f1", "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}], ">", "0"}], "&&", 
        RowBox[{
         RowBox[{"f0", "[", 
          RowBox[{"r", ",", "\[Theta]"}], "]"}], ">", "0"}], "&&", 
        RowBox[{
         RowBox[{"H", "[", "r", "]"}], ">", "0"}]}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"dim", "=", 
     RowBox[{"Length", "[", "gdd", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6730768754525843`*^9, 3.6730768845194817`*^9}, {
  3.6730769915165567`*^9, 3.6730770163093224`*^9}, {3.6730770568283253`*^9, 
  3.673077126549028*^9}, {3.673077406469137*^9, 3.673077415880056*^9}, {
  3.674208876024*^9, 3.6742088789609957`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"e", "[", 
       RowBox[{"i", ",", "j"}], "]"}], "=", 
      RowBox[{"edd", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "dim"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "dim"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.673076886409967*^9, 3.6730769130535603`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"eu", "[", 
       RowBox[{"i", ",", "j"}], "]"}], "=", 
      RowBox[{"euu", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ";"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "dim"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "dim"}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.673076895052144*^9, 3.673076917625422*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "euu", "]"}]], "Input",
 CellChangeTimes->{{3.671865133343354*^9, 3.6718652751119967`*^9}, {
  3.673077459162066*^9, 3.6730774976087914`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", 
       SqrtBox[
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"2", " ", 
            RowBox[{"f0", "[", 
             RowBox[{"r", ",", "\[Theta]"}], "]"}]}]], " ", 
          SuperscriptBox["r", "2"], " ", 
          RowBox[{"H", "[", "r", "]"}]}], 
         RowBox[{"g", "[", "r", "]"}]]]], "0", "0", 
      FractionBox[
       RowBox[{"W", "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}], 
       RowBox[{
        RowBox[{"g", "[", "r", "]"}], " ", 
        SqrtBox[
         FractionBox[
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{"2", " ", 
             RowBox[{"f0", "[", 
              RowBox[{"r", ",", "\[Theta]"}], "]"}]}]], " ", 
           SuperscriptBox["r", "2"], " ", 
           RowBox[{"H", "[", "r", "]"}]}], 
          RowBox[{"g", "[", "r", "]"}]]]}]]},
     {"0", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"f1", "[", 
           RowBox[{"r", ",", "\[Theta]"}], "]"}]}]], " ", 
        RowBox[{"H", "[", "r", "]"}]}]], "0", "0"},
     {"0", "0", 
      SqrtBox[
       FractionBox[
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"f1", "[", 
           RowBox[{"r", ",", "\[Theta]"}], "]"}]}]], 
        RowBox[{"g", "[", "r", "]"}]]], "0"},
     {"0", "0", "0", 
      SqrtBox[
       RowBox[{
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "2"}], " ", 
            RowBox[{"f0", "[", 
             RowBox[{"r", ",", "\[Theta]"}], "]"}]}]], " ", 
          SuperscriptBox[
           RowBox[{"W", "[", 
            RowBox[{"r", ",", "\[Theta]"}], "]"}], "2"]}], 
         RowBox[{
          SuperscriptBox["r", "2"], " ", 
          RowBox[{"g", "[", "r", "]"}], " ", 
          RowBox[{"H", "[", "r", "]"}]}]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             RowBox[{"f2", "[", 
              RowBox[{"r", ",", "\[Theta]"}], "]"}]}]], " ", 
           SuperscriptBox[
            RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"]}], "-", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "2"}], " ", 
              RowBox[{"f0", "[", 
               RowBox[{"r", ",", "\[Theta]"}], "]"}]}]], " ", 
            SuperscriptBox[
             RowBox[{"W", "[", 
              RowBox[{"r", ",", "\[Theta]"}], "]"}], "2"]}], 
           RowBox[{
            SuperscriptBox["r", "2"], " ", 
            RowBox[{"H", "[", "r", "]"}]}]]}], 
         RowBox[{"g", "[", "r", "]"}]]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.671865275740725*^9, {3.673077466645379*^9, 3.6730774933813257`*^9}, 
   3.673082369176566*^9, 3.6730825709568443`*^9, 3.673082668627589*^9, 
   3.6730827288450413`*^9, 3.673082767154291*^9, 3.673083017709854*^9, 
   3.67308338332311*^9, 3.673083553677956*^9, 3.673084110280614*^9, {
   3.6730843068542356`*^9, 3.673084333130556*^9}, 3.673084486411668*^9, 
   3.6730866471103373`*^9, 3.673170390419634*^9, 3.673171621066025*^9, 
   3.6731856064064817`*^9, 3.673185825357239*^9, 3.673185995214748*^9, 
   3.673186657670581*^9, 3.6731883790854187`*^9, 3.673508269277872*^9, {
   3.673508947236848*^9, 3.6735089693006496`*^9}, 3.6735092138091793`*^9, 
   3.673510028075473*^9, 3.67351099203963*^9, 3.673511553619718*^9, 
   3.6735119615863333`*^9, 3.673512425523346*^9, 3.673512952313932*^9, 
   3.673513956437483*^9, 3.673515082694578*^9, 3.673516736946763*^9, 
   3.6735925126481733`*^9, 3.673593657314629*^9, 3.673593751855948*^9, 
   3.673593813112104*^9, 3.6735949970727167`*^9, 3.6735955882599993`*^9, 
   3.673596361219674*^9, 3.673602575596649*^9, 3.6736101975025187`*^9, 
   3.673614242660584*^9, 3.673617820838244*^9, 3.673618454669477*^9, 
   3.6736185900651283`*^9, 3.673619756296689*^9, 3.6736296643701963`*^9, 
   3.67376298731633*^9, 3.673763592606139*^9, 3.673763809213511*^9, 
   3.673766490738213*^9, 3.6737671053060217`*^9, 3.673769782898119*^9, 
   3.674208957159791*^9, 3.674209114569097*^9, 3.674209748618122*^9, {
   3.674209801872521*^9, 3.674209817169013*^9}, {3.674209983246098*^9, 
   3.6742100109112597`*^9}, 3.67421174654361*^9, 3.674211877941113*^9, 
   3.674281464828286*^9, 3.674281510998143*^9, 3.674460982871683*^9, 
   3.674469404117773*^9, 3.6744705135412827`*^9, 3.674470872860264*^9, 
   3.6744718485016403`*^9, 3.674472051023632*^9, 3.674472506243435*^9, 
   3.674473675541101*^9}]
}, Open  ]],

Cell["\<\
And we find the electromagnetic tensor w.r.t the tetrad in the same way\
\>", "Text",
 CellChangeTimes->{{3.6735977062821693`*^9, 3.673597736234871*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"At", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}], "-", 
      RowBox[{
       RowBox[{"Aphi", "[", 
        RowBox[{"r", ",", "\[Theta]"}], "]"}], " ", 
       RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
       FractionBox[
        RowBox[{"W", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], 
        RowBox[{"g", "[", "r", "]"}]]}]}], ",", "0", ",", "0", ",", 
     RowBox[{
      RowBox[{"Aphi", "[", 
       RowBox[{"r", ",", "\[Theta]"}], "]"}], 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "A", "]"}]}], "Input",
 CellChangeTimes->{{3.670310286505966*^9, 3.670310393088498*^9}, {
  3.670310717435206*^9, 3.670310760740891*^9}, {3.670312846964416*^9, 
  3.6703128679121847`*^9}, {3.670314316666815*^9, 3.6703143237406683`*^9}, {
  3.67031435888336*^9, 3.670314359103088*^9}, {3.6703147228134737`*^9, 
  3.670314723187014*^9}, {3.670315630326792*^9, 3.670315650928248*^9}, {
  3.6703406380643272`*^9, 3.670340641567965*^9}, {3.671256521739168*^9, 
  3.671256578532535*^9}, {3.6712571320338917`*^9, 3.67125719503452*^9}, {
  3.671257337302898*^9, 3.671257405729622*^9}, {3.6712574734152193`*^9, 
  3.671257476121854*^9}, {3.671257543535338*^9, 3.67125755690234*^9}, {
  3.6730774791076927`*^9, 3.673077481275951*^9}, {3.673597705140142*^9, 
  3.673597723069027*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"At", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], "-", 
        FractionBox[
         RowBox[{
          RowBox[{"Aphi", "[", 
           RowBox[{"r", ",", "\[Theta]"}], "]"}], " ", 
          RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
          RowBox[{"W", "[", 
           RowBox[{"r", ",", "\[Theta]"}], "]"}]}], 
         RowBox[{"g", "[", "r", "]"}]]}]},
      {"0"},
      {"0"},
      {
       RowBox[{
        RowBox[{"Aphi", "[", 
         RowBox[{"r", ",", "\[Theta]"}], "]"}], " ", 
        RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.670340641837326*^9, 3.6712565809325943`*^9, 3.671256740856138*^9, {
   3.671257155414455*^9, 3.671257195526492*^9}, 3.671257418395262*^9, {
   3.671257466526883*^9, 3.67125747685231*^9}, 3.671257583786457*^9, 
   3.671259590332329*^9, {3.673077476606799*^9, 3.673077481515873*^9}, 
   3.673082373518648*^9, 3.6730825709854393`*^9, 3.673082668656823*^9, 
   3.673082728864326*^9, 3.673082767175385*^9, 3.67308301773381*^9, 
   3.673083383352108*^9, 3.673083554182225*^9, 3.6730841103074017`*^9, {
   3.6730843068768682`*^9, 3.6730843331530247`*^9}, 3.673084486435438*^9, 
   3.673086650619128*^9, 3.673170390434963*^9, 3.673171621086958*^9, 
   3.67318560642703*^9, 3.673185825375413*^9, 3.673185995232129*^9, 
   3.673186657703843*^9, 3.673188379124614*^9, 3.6735082693062696`*^9, {
   3.6735089472682133`*^9, 3.673508969332067*^9}, 3.673509213839028*^9, 
   3.673510028090372*^9, 3.6735109920640993`*^9, 3.6735115536426277`*^9, 
   3.673511961605798*^9, 3.673512425537065*^9, 3.673512952330166*^9, 
   3.673513956453672*^9, 3.67351508270748*^9, 3.6735167369656076`*^9, 
   3.673592512692692*^9, 3.673593657337104*^9, 3.673593751885968*^9, 
   3.6735938131463747`*^9, 3.6735949971007137`*^9, 3.673595588284774*^9, 
   3.6735963612475653`*^9, 3.673602575624407*^9, 3.6736101975230703`*^9, 
   3.673614242685322*^9, 3.673617820864531*^9, 3.673618454696887*^9, 
   3.673618590094019*^9, 3.673619756319911*^9, 3.6736296643918037`*^9, 
   3.6737629873365602`*^9, 3.673763592650014*^9, 3.673763809257742*^9, 
   3.673766490814909*^9, 3.673767105325717*^9, 3.6737697829387207`*^9, 
   3.6742089571816673`*^9, 3.674209114590897*^9, 3.674209748642642*^9, {
   3.674209801902793*^9, 3.674209817192705*^9}, {3.674209983254325*^9, 
   3.674210011132615*^9}, 3.6742117465670233`*^9, 3.674211877960294*^9, 
   3.674281464853539*^9, 3.674281511021949*^9, 3.6744609828878098`*^9, 
   3.674469404203163*^9, 3.674470513560631*^9, 3.674470872879364*^9, 
   3.6744718485274754`*^9, 3.674472051049226*^9, 3.674472506267129*^9, 
   3.6744736755790358`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"F_\[Mu]\[Nu]", " ", "=", " ", 
    RowBox[{
     RowBox[{"d_\[Mu]", " ", "A_\[Nu]"}], " ", "-", " ", 
     RowBox[{"d_\[Nu]", " ", "A_\[Mu]"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"F", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", "\[Nu]", "]"}], "]"}], ",", 
          RowBox[{"coords", "[", 
           RowBox[{"[", "\[Mu]", "]"}], "]"}]}], "]"}], " ", "-", " ", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"A", "[", 
           RowBox[{"[", "\[Mu]", "]"}], "]"}], ",", 
          RowBox[{"coords", "[", 
           RowBox[{"[", "\[Nu]", "]"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "1", ",", "dim"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "1", ",", "dim"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", "F", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.67031078397996*^9, 3.67031078423285*^9}, {
   3.670310818474059*^9, 3.670310881570541*^9}, {3.670310929517544*^9, 
   3.670310953290669*^9}, {3.670311092291007*^9, 3.670311097306085*^9}, {
   3.670314363485124*^9, 3.670314373815033*^9}, {3.670314419504573*^9, 
   3.6703144332682543`*^9}, {3.67031827643913*^9, 3.6703182781638727`*^9}, {
   3.671257203946474*^9, 3.671257231180093*^9}, {3.6712573710180817`*^9, 
   3.671257382222705*^9}, 3.671257479773975*^9, {3.671257560964157*^9, 
   3.6712575713145733`*^9}, 3.6712576128887568`*^9, {3.673076942845623*^9, 
   3.673076945287434*^9}, {3.673077584600627*^9, 3.6730775853707*^9}, 
   3.673077741979691*^9, {3.6730866600686502`*^9, 3.673086681657816*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"F_ab", " ", "=", " ", 
    RowBox[{"F_\[Mu]\[Nu]", " ", 
     RowBox[{"e_a", "^", "\[Mu]"}], " ", 
     RowBox[{"e_b", "^", "\[Nu]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tetradF", " ", "=", " ", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"F", "[", 
             RowBox[{"[", 
              RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "]"}], 
            RowBox[{"euu", "[", 
             RowBox[{"[", 
              RowBox[{"b", ",", "\[Mu]"}], "]"}], "]"}], 
            RowBox[{"euu", "[", 
             RowBox[{"[", 
              RowBox[{"c", ",", "\[Nu]"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "1", ",", "dim"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Nu]", ",", "1", ",", "dim"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "1", ",", "dim"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"c", ",", "1", ",", "dim"}], "}"}]}], "]"}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Theta]", "]"}], ">", "0"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", "tetradF", "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.670311098543384*^9, 3.670311128695478*^9}, {
  3.6703111735258017`*^9, 3.6703111806695623`*^9}, {3.670311313685257*^9, 
  3.670311343186254*^9}, {3.670311391023428*^9, 3.67031143566626*^9}, {
  3.670313205228531*^9, 3.6703132215293627`*^9}, {3.670314377958124*^9, 
  3.67031441496974*^9}, {3.670315424157473*^9, 3.670315429870261*^9}, {
  3.6703156689215193`*^9, 3.670315674760992*^9}, {3.67031585232071*^9, 
  3.670315866185727*^9}, {3.6703182994047203`*^9, 3.67031829981291*^9}, {
  3.6712574113375683`*^9, 3.671257416808638*^9}, {3.671257576140461*^9, 
  3.671257582658752*^9}, {3.673076948872467*^9, 3.673076956116972*^9}, {
  3.67307761563233*^9, 3.673077622448473*^9}, {3.673077737523241*^9, 
  3.67307775463065*^9}, {3.673086672682241*^9, 3.673086678792*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CurlyEpsilon]", "=", 
   RowBox[{"LeviCivitaTensor", "[", "4", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6744608297472277`*^9, 3.674460846177767*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"b", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[CurlyEpsilon]", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "i", ",", "j", ",", "k"}], "]"}], "]"}], " ", 
        RowBox[{"tetradF", "[", 
         RowBox[{"[", 
          RowBox[{"j", ",", "k"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "dim"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "dim"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6744608297472277`*^9, 3.674460846177767*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"e", "[", 
    RowBox[{"r_", ",", "\[Theta]_"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"tetradF", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", 
        RowBox[{"i", "+", "1"}]}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6744608297472277`*^9, 3.674460845398756*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", "r_", "]"}], ":=", 
   RowBox[{"1", "-", 
    FractionBox["rh", "r"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"g", "[", "r_", "]"}], " ", ":=", " ", 
   RowBox[{
    SuperscriptBox["r", "2"], "+", 
    SuperscriptBox["rh", "2"]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.670316281960452*^9, 3.670316314575738*^9}, {
   3.671256760065456*^9, 3.6712567729312267`*^9}, 3.673082749878227*^9, 
   3.6731865183005753`*^9, {3.673508251411538*^9, 3.673508255877849*^9}, {
   3.673595589485819*^9, 3.673595596953208*^9}, {3.67359631229637*^9, 
   3.673596315179966*^9}, {3.673596352108878*^9, 3.673596352274219*^9}}],

Cell["\<\
Here I read the solution and interpolate it onto a (r,\[Theta]) grid.\
\>", "Text",
 CellChangeTimes->{{3.673597743104248*^9, 3.673597773498816*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dat", "=", 
   RowBox[{"ReadList", "[", 
    RowBox[{"\"\<funct.dat\>\"", ",", "Number", ",", 
     RowBox[{"RecordLists", "\[Rule]", "True"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nx", "=", "251"}], ";", 
  RowBox[{"ny", "=", "30"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"xmax", "=", 
   RowBox[{"dat", "[", 
    RowBox[{"[", 
     RowBox[{"251", ",", "1"}], "]"}], "]"}]}], ";", 
  RowBox[{"xmin", "=", 
   RowBox[{"dat", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ymax", "=", 
   RowBox[{"dat", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"nx", "*", "ny"}], ",", "2"}], "]"}], "]"}]}], ";", 
  RowBox[{"ymin", "=", 
   RowBox[{"dat", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6730782426713543`*^9, 3.67307825910703*^9}, {
  3.6730783914351788`*^9, 3.673078393426484*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"conf", "=", 
   RowBox[{"ReadList", "[", 
    RowBox[{"\"\<res.txt\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
      "Number", ",", "Number", ",", "Number", ",", "Number", ",", "Number", 
       ",", "Number", ",", "Number"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nr", "=", 
   RowBox[{
    RowBox[{"conf", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"rh", "=", 
   RowBox[{
    RowBox[{"conf", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"V", "=", 
   RowBox[{
    RowBox[{"conf", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{
    RowBox[{"conf", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.673078293695404*^9, 3.673078305287818*^9}, {
  3.673184962787829*^9, 3.673184965760601*^9}, {3.673185020840412*^9, 
  3.673185021136218*^9}, {3.6731865059097853`*^9, 3.6731865080323668`*^9}, {
  3.673508240804137*^9, 3.673508240910389*^9}, {3.673509199023986*^9, 
  3.6735091991067667`*^9}, {3.673513943480736*^9, 3.673513948223028*^9}, {
  3.6736185805519533`*^9, 3.6736185806514072`*^9}, {3.673629595194921*^9, 
  3.673629649711728*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Xtor", "[", "X_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"X", "\[NotEqual]", "1"}], ",", 
    RowBox[{"Sqrt", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"X", "/", 
         RowBox[{"(", 
          RowBox[{"1", "-", "X"}], ")"}]}], ")"}], "2"], "+", 
      SuperscriptBox["rh", "2"]}], "]"}], ",", "1000"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.67307826047838*^9, 3.6730782607208014`*^9}, 
   3.673078347353964*^9, {3.6731874241596746`*^9, 3.6731874342024527`*^9}, {
   3.673187641639648*^9, 3.6731876421252413`*^9}, {3.673187710090035*^9, 
   3.673187730002036*^9}, 3.6735949899685993`*^9, {3.673595686481802*^9, 
   3.6735956878906403`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Xtor", "[", 
        RowBox[{"dat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"j", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "1"}], 
          "]"}], "]"}], "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "2"}], "]"}],
         "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "3"}], "]"}],
         "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ny"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nx"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"f2", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Xtor", "[", 
        RowBox[{"dat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"j", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "1"}], 
          "]"}], "]"}], "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "2"}], "]"}],
         "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "4"}], "]"}],
         "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ny"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nx"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"f0", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Xtor", "[", 
        RowBox[{"dat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"j", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "1"}], 
          "]"}], "]"}], "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "2"}], "]"}],
         "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "5"}], "]"}],
         "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ny"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nx"}], "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Xtor", "[", 
        RowBox[{"dat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"j", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "1"}], 
          "]"}], "]"}], "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "2"}], "]"}],
         "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "6"}], "]"}],
         "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ny"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nx"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Xtor", "[", 
        RowBox[{"dat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"j", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "1"}], 
          "]"}], "]"}], "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "2"}], "]"}],
         "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "7"}], "]"}],
         "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ny"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nx"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Aphi", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Xtor", "[", 
        RowBox[{"dat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"j", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "1"}], 
          "]"}], "]"}], "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "2"}], "]"}],
         "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "8"}], "]"}],
         "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ny"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nx"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"At", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Xtor", "[", 
        RowBox[{"dat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"j", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "1"}], 
          "]"}], "]"}], "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "2"}], "]"}],
         "]"}], ",", 
       RowBox[{"dat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"j", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"i", "-", "1"}], ")"}], "*", "nx"}]}], ",", "9"}], "]"}],
         "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "ny"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "1", ",", "nx"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.673078348724844*^9, 3.673078381600416*^9}, {
   3.673511539311727*^9, 3.673511546760179*^9}, {3.673512414185052*^9, 
   3.6735124167269373`*^9}, {3.673513995673727*^9, 3.673513998970783*^9}, 
   3.673514265071547*^9, 3.6735927015056477`*^9, 3.6735927508717937`*^9, 
   3.673597779155788*^9, {3.6736197228385353`*^9, 3.673619731165539*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"if1", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"f1", ",", "1"}], "]"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "4"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"if2", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"f2", ",", "1"}], "]"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "4"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"if0", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"f0", ",", "1"}], "]"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "4"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"iZ", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Z", ",", "1"}], "]"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "4"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iW", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"W", ",", "1"}], "]"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "4"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iAphi", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"Aphi", ",", "1"}], "]"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "4"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iAt", "=", 
   RowBox[{"Interpolation", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{"At", ",", "1"}], "]"}], ",", 
     RowBox[{"InterpolationOrder", "\[Rule]", "4"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.673078430269459*^9, 3.6730784488013487`*^9}, {
  3.673082557560894*^9, 3.673082567658155*^9}, {3.673082709527957*^9, 
  3.673082718851707*^9}, {3.673513992005712*^9, 3.673513992218553*^9}, {
  3.6736197350006437`*^9, 3.6736197396055813`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", "=", "if1"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"f2", "=", "if2"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"f0", "=", "if0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Z", "=", "iZ"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"W", "=", "iW"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Aphi", "=", "iAphi"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"At", "=", "iAt"}], ";"}]}], "Input",
 CellChangeTimes->{{3.673082257547111*^9, 3.673082290174776*^9}, {
  3.673082421010003*^9, 3.673082446669702*^9}, {3.673514004303543*^9, 
  3.6735140044529743`*^9}, {3.673619742529169*^9, 3.673619744669083*^9}}],

Cell["\<\
Just as with the analytical case, we define some transformations from the \
tetrad coordinates to Cartesian coordinates\
\>", "Text",
 CellChangeTimes->{{3.673597788283608*^9, 3.673597807776568*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"r", "=."}], ";", 
  RowBox[{"\[Theta]", "=."}], ";", 
  RowBox[{"\[Phi]", "=."}], ";", 
  RowBox[{"x", "=."}], ";", 
  RowBox[{"y", "=."}], ";", 
  RowBox[{"z", "=."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "[", 
   RowBox[{"r_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{"r", " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
   RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"y", "[", 
   RowBox[{"r_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{"r", " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
   RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], "\n", 
 RowBox[{
  RowBox[{"z", "[", 
   RowBox[{"r_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{"r", " ", 
   RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.673084193626768*^9, 3.673084194287931*^9}, {
  3.673084392318128*^9, 3.673084393942357*^9}, {3.6730844713835373`*^9, 
  3.6730844833834887`*^9}, {3.6731887719061623`*^9, 3.673188779278878*^9}, {
  3.673188828400093*^9, 3.673188833637103*^9}, {3.674212298008698*^9, 
  3.6742122981586123`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ex", "[", 
   RowBox[{"r_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], "[", 
     RowBox[{"[", "3", "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"ey", "[", 
   RowBox[{"r_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], "[", 
     RowBox[{"[", "3", "]"}], "]"}], " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"ez", "[", 
   RowBox[{"r_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
   RowBox[{
    RowBox[{
     RowBox[{"e", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.674460858269555*^9, 3.67446085994489*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bx", "[", 
   RowBox[{"r_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"b", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "+", 
   RowBox[{
    RowBox[{
     RowBox[{"b", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}]}], "-", 
   RowBox[{
    RowBox[{
     RowBox[{"b", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], "[", 
     RowBox[{"[", "3", "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"by", "[", 
   RowBox[{"r_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"b", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
   RowBox[{
    RowBox[{
     RowBox[{"b", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Phi]", "]"}]}], "+", 
   RowBox[{
    RowBox[{
     RowBox[{"b", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], "[", 
     RowBox[{"[", "3", "]"}], "]"}], " ", 
    RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}]}], "\n", 
 RowBox[{
  RowBox[{"bz", "[", 
   RowBox[{"r_", ",", "\[Theta]_", ",", "\[Phi]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"b", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}], " ", 
    RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "-", 
   RowBox[{
    RowBox[{
     RowBox[{"b", "[", 
      RowBox[{"r", ",", "\[Theta]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], " ", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.674460858269555*^9, 3.67446085994489*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Piecewise", "[", 
  RowBox[{
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", 
       RowBox[{
        RowBox[{"r", ">", "rh"}], "&&", 
        RowBox[{"z", ">", "0"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"b", ",", 
       RowBox[{
        RowBox[{"r", ">", "rh"}], "&&", 
        RowBox[{"z", "<", "0"}]}]}], "}"}]}], "}"}], ",", "0"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.674473651356161*^9, 3.674473651713778*^9}, {
  3.6744737023833103`*^9, 3.67447373551187*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {"a", 
        RowBox[{
         RowBox[{"r", ">", "0.02`"}], "&&", 
         RowBox[{"z", ">", "0"}]}]},
       {"b", 
        RowBox[{
         RowBox[{"r", ">", "0.02`"}], "&&", 
         RowBox[{"z", "<", "0"}]}]},
       {"0", 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{{3.674473652461513*^9, 3.674473735914722*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlotYZEfield", "[", "n_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r", ",", "\[Theta]", ",", 
      RowBox[{"\[Phi]", "=", 
       RowBox[{"\[Pi]", "/", "2"}]}], ",", 
      RowBox[{"x", "=", "0"}], ",", "y", ",", "z"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"x", "^", "2"}], "+", 
        RowBox[{"y", "^", "2"}], "+", 
        RowBox[{"z", "^", "2"}]}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"\[Theta]", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"z", "/", 
        RowBox[{"r", "[", 
         RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rMax", "=", 
      RowBox[{"n", " ", "rh"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"YZey", "=", 
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"y", ",", "z", ",", "\[IndentingNewLine]", 
              RowBox[{"Piecewise", "[", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ey", "[", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "\[Phi]"}],
                     "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], "^", "2"}], ">", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}], "&&", 
                    RowBox[{"z", ">", "0"}]}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ey", "[", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"-", "z"}]}], "]"}], ",", 
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"-", "z"}]}], "]"}], ",", "\[Phi]"}], "]"}], ",", 
                    
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"-", "z"}]}], "]"}], "^", "2"}], ">", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}], "&&", 
                    RowBox[{"z", "<", "0"}]}]}], "}"}]}], "}"}], ",", 
                "\[IndentingNewLine]", "0"}], "]"}]}], "\[IndentingNewLine]", 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "rMax"}], ",", "rMax", ",", 
              RowBox[{"rMax", "/", "100"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", 
              RowBox[{"-", "rMax"}], ",", "rMax", ",", 
              RowBox[{"rMax", "/", "100"}]}], "}"}]}], "]"}], ",", "1"}], 
         "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"YZez", "=", 
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"y", ",", "z", ",", "\[IndentingNewLine]", 
              RowBox[{"Piecewise", "[", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ez", "[", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "\[Phi]"}],
                     "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], "^", "2"}], ">", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}], "&&", 
                    RowBox[{"z", ">", "0"}]}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"ez", "[", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"-", "z"}]}], "]"}], ",", 
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"-", "z"}]}], "]"}], ",", "\[Phi]"}], "]"}], ",", 
                    
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"-", "z"}]}], "]"}], "^", "2"}], ">", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}], "&&", 
                    RowBox[{"z", "<", "0"}]}]}], "}"}]}], "}"}], ",", 
                "\[IndentingNewLine]", "0"}], "]"}]}], "\[IndentingNewLine]", 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "rMax"}], ",", "rMax", ",", 
              RowBox[{"rMax", "/", "100"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", 
              RowBox[{"-", "rMax"}], ",", "rMax", ",", 
              RowBox[{"rMax", "/", "100"}]}], "}"}]}], "]"}], ",", "1"}], 
         "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"YZe", "[", 
       RowBox[{"y_", ",", "z_"}], "]"}], "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"YZey", "[", 
          RowBox[{"y", ",", "z"}], "]"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"YZez", "[", 
          RowBox[{"y", ",", "z"}], "]"}], "^", "2"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DYZe", "[", 
       RowBox[{"y_", ",", "z_"}], "]"}], "=", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"YZe", "[", 
         RowBox[{"y", ",", "z"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"y", ",", "z"}], "}"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cP", "=", 
      RowBox[{"ContourPlot", "[", 
       RowBox[{
        RowBox[{"Piecewise", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"YZe", "[", 
              RowBox[{"Y", ",", "Z"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Y", "^", "2"}], "+", 
               RowBox[{"Z", "^", "2"}]}], ">", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}]}], "}"}], 
           "}"}], ",", "0"}], "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"Y", ",", 
          RowBox[{"-", "rMax"}], ",", "rMax"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", 
          RowBox[{"-", "rMax"}], ",", "rMax"}], "}"}], ",", 
        RowBox[{"Contours", "\[Rule]", "8"}], ",", 
        RowBox[{"ContourStyle", "\[Rule]", "Red"}], ",", 
        RowBox[{"ContourShading", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{"BarLegend", "[", 
            RowBox[{"Automatic", ",", 
             RowBox[{"LegendMarkerSize", "\[Rule]", "150"}], ",", 
             RowBox[{"LegendMargins", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "5"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "10"}], ",", "0"}], "}"}]}], "}"}]}]}], "]"}], 
           ",", "Right"}], "]"}]}], ",", 
        RowBox[{"ColorFunction", "\[Rule]", "\"\<Pastel\>\""}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"sP", "=", 
      RowBox[{"StreamPlot", "[", 
       RowBox[{
        RowBox[{"Piecewise", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"DYZe", "[", 
              RowBox[{"Y", ",", "Z"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Y", "^", "2"}], "+", 
               RowBox[{"Z", "^", "2"}]}], ">", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}]}], "}"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"Y", ",", 
          RowBox[{"-", "rMax"}], ",", "rMax"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", 
          RowBox[{"-", "rMax"}], ",", "rMax"}], "}"}], ",", 
        RowBox[{"StreamPoints", "\[Rule]", "Coarse"}], ",", 
        RowBox[{"StreamStyle", "\[Rule]", "Blue"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"cP", ",", "sP", ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"y", ",", "z"}], "}"}]}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.674281416554998*^9, 3.674281448293186*^9}, 
   3.674281531254747*^9, {3.674460872389488*^9, 3.674460951378728*^9}, {
   3.674461051531673*^9, 3.674461055898841*^9}, {3.674461444535832*^9, 
   3.67446145416796*^9}, {3.674472401284626*^9, 3.6744724053232613`*^9}, {
   3.674473324817325*^9, 3.6744733420699043`*^9}, {3.674473640082368*^9, 
   3.674473643252035*^9}, {3.674473742371665*^9, 3.674473765842085*^9}, {
   3.674473801356593*^9, 3.674473935918757*^9}, {3.674474167964097*^9, 
   3.6744741681008167`*^9}, {3.674474198573181*^9, 3.6744741986957483`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlotYZBfield", "[", "n_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r", ",", "\[Theta]", ",", 
      RowBox[{"\[Phi]", "=", 
       RowBox[{"\[Pi]", "/", "2"}]}], ",", 
      RowBox[{"x", "=", "0"}], ",", "y", ",", "z"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"x", "^", "2"}], "+", 
        RowBox[{"y", "^", "2"}], "+", 
        RowBox[{"z", "^", "2"}]}], "]"}]}], ";", 
     RowBox[{
      RowBox[{"\[Theta]", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"ArcCos", "[", 
       RowBox[{"z", "/", 
        RowBox[{"r", "[", 
         RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"rMax", "=", 
      RowBox[{"n", " ", "rh"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"YZby", "=", 
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"y", ",", "z", ",", "\[IndentingNewLine]", 
              RowBox[{"Piecewise", "[", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"by", "[", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "\[Phi]"}],
                     "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], "^", "2"}], ">", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}], "&&", 
                    RowBox[{"z", ">", "0"}]}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"by", "[", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"-", "z"}]}], "]"}], ",", 
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"-", "z"}]}], "]"}], ",", "\[Phi]"}], "]"}], ",", 
                    
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"-", "z"}]}], "]"}], "^", "2"}], ">", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}], "&&", 
                    RowBox[{"z", "<", "0"}]}]}], "}"}]}], "}"}], ",", 
                "\[IndentingNewLine]", "0"}], "]"}]}], "\[IndentingNewLine]", 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "rMax"}], ",", "rMax", ",", 
              RowBox[{"rMax", "/", "100"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", 
              RowBox[{"-", "rMax"}], ",", "rMax", ",", 
              RowBox[{"rMax", "/", "100"}]}], "}"}]}], "]"}], ",", "1"}], 
         "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"YZbz", "=", 
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"y", ",", "z", ",", "\[IndentingNewLine]", 
              RowBox[{"Piecewise", "[", 
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"bz", "[", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "\[Phi]"}],
                     "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], "^", "2"}], ">", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}], "&&", 
                    RowBox[{"z", ">", "0"}]}]}], "}"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"bz", "[", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"-", "z"}]}], "]"}], ",", 
                    RowBox[{"\[Theta]", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"-", "z"}]}], "]"}], ",", "\[Phi]"}], "]"}], ",", 
                    
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", 
                    RowBox[{"-", "z"}]}], "]"}], "^", "2"}], ">", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}], "&&", 
                    RowBox[{"z", "<", "0"}]}]}], "}"}]}], "}"}], ",", 
                "\[IndentingNewLine]", "0"}], "]"}]}], "\[IndentingNewLine]", 
             "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "rMax"}], ",", "rMax", ",", 
              RowBox[{"rMax", "/", "100"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", 
              RowBox[{"-", "rMax"}], ",", "rMax", ",", 
              RowBox[{"rMax", "/", "100"}]}], "}"}]}], "]"}], ",", "1"}], 
         "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"YZb", "[", 
       RowBox[{"y_", ",", "z_"}], "]"}], "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"YZby", "[", 
          RowBox[{"y", ",", "z"}], "]"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"YZbz", "[", 
          RowBox[{"y", ",", "z"}], "]"}], "^", "2"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DYZb", "[", 
       RowBox[{"y_", ",", "z_"}], "]"}], "=", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"YZb", "[", 
         RowBox[{"y", ",", "z"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"y", ",", "z"}], "}"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cP", "=", 
      RowBox[{"ContourPlot", "[", 
       RowBox[{
        RowBox[{"Piecewise", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"YZb", "[", 
              RowBox[{"Y", ",", "Z"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Y", "^", "2"}], "+", 
               RowBox[{"Z", "^", "2"}]}], ">", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}]}], "}"}], 
           "}"}], ",", "0"}], "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"Y", ",", 
          RowBox[{"-", "rMax"}], ",", "rMax"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", 
          RowBox[{"-", "rMax"}], ",", "rMax"}], "}"}], ",", 
        RowBox[{"Contours", "\[Rule]", "8"}], ",", 
        RowBox[{"ContourStyle", "\[Rule]", "Red"}], ",", 
        RowBox[{"ContourShading", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{"BarLegend", "[", 
            RowBox[{"Automatic", ",", 
             RowBox[{"LegendMarkerSize", "\[Rule]", "150"}], ",", 
             RowBox[{"LegendMargins", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "5"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "10"}], ",", "0"}], "}"}]}], "}"}]}]}], "]"}], 
           ",", "Right"}], "]"}]}], ",", 
        RowBox[{"ColorFunction", "\[Rule]", "\"\<Pastel\>\""}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"sP", "=", 
      RowBox[{"StreamPlot", "[", 
       RowBox[{
        RowBox[{"Piecewise", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"DYZb", "[", 
              RowBox[{"Y", ",", "Z"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"Y", "^", "2"}], "+", 
               RowBox[{"Z", "^", "2"}]}], ">", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}]}], "}"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"Y", ",", 
          RowBox[{"-", "rMax"}], ",", "rMax"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Z", ",", 
          RowBox[{"-", "rMax"}], ",", "rMax"}], "}"}], ",", 
        RowBox[{"StreamPoints", "\[Rule]", "Coarse"}], ",", 
        RowBox[{"StreamStyle", "\[Rule]", "Blue"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"cP", ",", "sP", ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"y", ",", "z"}], "}"}]}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.674281416554998*^9, 3.674281448293186*^9}, 
   3.674281531254747*^9, {3.674460872389488*^9, 3.674460951378728*^9}, {
   3.674461051531673*^9, 3.674461055898841*^9}, {3.674461172954235*^9, 
   3.674461199038473*^9}, {3.674472411297081*^9, 3.674472432632983*^9}, {
   3.674473348538134*^9, 3.674473358874776*^9}, {3.674474162678071*^9, 
   3.674474220790762*^9}, 3.674474620952943*^9, {3.67447468516545*^9, 
   3.6744746942086143`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlotXYEfield", "[", "n_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r", ",", 
      RowBox[{"\[Theta]", "=", 
       RowBox[{"\[Pi]", "/", "2"}]}], ",", "\[Phi]", ",", "x", ",", "y", ",", 
      
      RowBox[{"z", "=", "0"}], ",", "rMax"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"x", "^", "2"}], "+", 
        RowBox[{"y", "^", "2"}], "+", 
        RowBox[{"z", "^", "2"}]}], "]"}]}], ";", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"\[Pi]", "/", "2"}]}], ";", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"ArcTan", "[", 
       RowBox[{"y", "/", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rMax", "=", 
      RowBox[{"n", " ", "rh"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"XYex", "=", 
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "\[IndentingNewLine]", 
              RowBox[{"Piecewise", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ex", "[", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "\[Theta]",
                     ",", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "]"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], "^", "2"}], ">", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}], "&&", 
                    RowBox[{"x", "\[NotEqual]", "0"}]}]}], "}"}], "}"}], ",", 
                "0"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "rMax"}], ",", "rMax", ",", 
              RowBox[{"rMax", "/", "100"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "rMax"}], ",", "rMax", ",", 
              RowBox[{"rMax", "/", "100"}]}], "}"}]}], "]"}], ",", "1"}], 
         "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"XYey", "=", 
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "\[IndentingNewLine]", 
              RowBox[{"Piecewise", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"ey", "[", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "\[Theta]",
                     ",", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "]"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], "^", "2"}], ">", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}], "&&", 
                    RowBox[{"x", "\[NotEqual]", "0"}]}]}], "}"}], "}"}], ",", 
                "0"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "rMax"}], ",", "rMax", ",", 
              RowBox[{"rMax", "/", "100"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "rMax"}], ",", "rMax", ",", 
              RowBox[{"rMax", "/", "100"}]}], "}"}]}], "]"}], ",", "1"}], 
         "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"XYe", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}], "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"XYex", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"XYey", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "^", "2"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DXYe", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}], "=", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"XYe", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cP", "=", 
      RowBox[{"ContourPlot", "[", 
       RowBox[{
        RowBox[{"Piecewise", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"XYe", "[", 
              RowBox[{"X", ",", "Y"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"X", "^", "2"}], "+", 
               RowBox[{"Y", "^", "2"}]}], ">", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}]}], "}"}], 
           "}"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", 
          RowBox[{"-", "rMax"}], ",", "rMax"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Y", ",", 
          RowBox[{"-", "rMax"}], ",", "rMax"}], "}"}], ",", 
        RowBox[{"Contours", "\[Rule]", "8"}], ",", 
        RowBox[{"ContourStyle", "\[Rule]", "Red"}], ",", 
        RowBox[{"ContourShading", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{"BarLegend", "[", 
            RowBox[{"Automatic", ",", 
             RowBox[{"LegendMarkerSize", "\[Rule]", "150"}], ",", 
             RowBox[{"LegendMargins", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "5"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "10"}], ",", "0"}], "}"}]}], "}"}]}]}], "]"}], 
           ",", "Right"}], "]"}]}], ",", 
        RowBox[{"ColorFunction", "\[Rule]", "\"\<Pastel\>\""}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"sP", "=", 
      RowBox[{"StreamPlot", "[", 
       RowBox[{
        RowBox[{"Piecewise", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"DXYe", "[", 
              RowBox[{"X", ",", "Y"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"X", "^", "2"}], "+", 
               RowBox[{"Y", "^", "2"}]}], ">", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}]}], "}"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", 
          RowBox[{"-", "rMax"}], ",", "rMax"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Y", ",", 
          RowBox[{"-", "rMax"}], ",", "rMax"}], "}"}], ",", 
        RowBox[{"StreamPoints", "\[Rule]", "Coarse"}], ",", 
        RowBox[{"StreamStyle", "\[Rule]", "Blue"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"cP", ",", "sP", ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.674281607379054*^9, 3.674281645920444*^9}, {
  3.674469581731977*^9, 3.674469661266024*^9}, {3.674469903266707*^9, 
  3.674469907510356*^9}, {3.674470008241066*^9, 3.674470013273748*^9}, {
  3.6744711341291523`*^9, 3.674471136856646*^9}, {3.674472426919723*^9, 
  3.674472437322617*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PlotXYBfield", "[", "n_", "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"r", ",", 
      RowBox[{"\[Theta]", "=", 
       RowBox[{"\[Pi]", "/", "2"}]}], ",", "\[Phi]", ",", "x", ",", "y", ",", 
      
      RowBox[{"z", "=", "0"}], ",", "rMax"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"r", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{"x", "^", "2"}], "+", 
        RowBox[{"y", "^", "2"}], "+", 
        RowBox[{"z", "^", "2"}]}], "]"}]}], ";", 
     RowBox[{"\[Theta]", "=", 
      RowBox[{"\[Pi]", "/", "2"}]}], ";", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
      RowBox[{"ArcTan", "[", 
       RowBox[{"y", "/", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rMax", "=", 
      RowBox[{"n", " ", "rh"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"XYbx", "=", 
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "\[IndentingNewLine]", 
              RowBox[{"Piecewise", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"bx", "[", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "\[Theta]",
                     ",", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "]"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], "^", "2"}], ">", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}], "&&", 
                    RowBox[{"x", "\[NotEqual]", "0"}]}]}], "}"}], "}"}], ",", 
                "0"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "rMax"}], ",", "rMax", ",", 
              RowBox[{"rMax", "/", "100"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "rMax"}], ",", "rMax", ",", 
              RowBox[{"rMax", "/", "100"}]}], "}"}]}], "]"}], ",", "1"}], 
         "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"XYby", "=", 
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y", ",", "\[IndentingNewLine]", 
              RowBox[{"Piecewise", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"by", "[", 
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "\[Theta]",
                     ",", 
                    RowBox[{"\[Phi]", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "]"}], ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"r", "[", 
                    RowBox[{"x", ",", "y", ",", "z"}], "]"}], "^", "2"}], ">", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}], "&&", 
                    RowBox[{"x", "\[NotEqual]", "0"}]}]}], "}"}], "}"}], ",", 
                "0"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", 
              RowBox[{"-", "rMax"}], ",", "rMax", ",", 
              RowBox[{"rMax", "/", "100"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", 
              RowBox[{"-", "rMax"}], ",", "rMax", ",", 
              RowBox[{"rMax", "/", "100"}]}], "}"}]}], "]"}], ",", "1"}], 
         "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"XYb", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}], "=", 
      RowBox[{"Sqrt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"XYbx", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "^", "2"}], "+", 
        RowBox[{
         RowBox[{"XYby", "[", 
          RowBox[{"x", ",", "y"}], "]"}], "^", "2"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"DXYb", "[", 
       RowBox[{"x_", ",", "y_"}], "]"}], "=", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"XYb", "[", 
         RowBox[{"x", ",", "y"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y"}], "}"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"cP", "=", 
      RowBox[{"ContourPlot", "[", 
       RowBox[{
        RowBox[{"Piecewise", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"XYb", "[", 
              RowBox[{"X", ",", "Y"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"X", "^", "2"}], "+", 
               RowBox[{"Y", "^", "2"}]}], ">", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}]}], "}"}], 
           "}"}], ",", "0"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", 
          RowBox[{"-", "rMax"}], ",", "rMax"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Y", ",", 
          RowBox[{"-", "rMax"}], ",", "rMax"}], "}"}], ",", 
        RowBox[{"Contours", "\[Rule]", "8"}], ",", 
        RowBox[{"ContourStyle", "\[Rule]", "Red"}], ",", 
        RowBox[{"ContourShading", "\[Rule]", "Automatic"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{"BarLegend", "[", 
            RowBox[{"Automatic", ",", 
             RowBox[{"LegendMarkerSize", "\[Rule]", "150"}], ",", 
             RowBox[{"LegendMargins", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "5"}], ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "10"}], ",", "0"}], "}"}]}], "}"}]}]}], "]"}], 
           ",", "Right"}], "]"}]}], ",", 
        RowBox[{"ColorFunction", "\[Rule]", "\"\<Pastel\>\""}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"sP", "=", 
      RowBox[{"StreamPlot", "[", 
       RowBox[{
        RowBox[{"Piecewise", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"DXYb", "[", 
              RowBox[{"X", ",", "Y"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"X", "^", "2"}], "+", 
               RowBox[{"Y", "^", "2"}]}], ">", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"rh", "+", "0.01"}], ")"}], "^", "2"}]}]}], "}"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", 
          RowBox[{"-", "rMax"}], ",", "rMax"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Y", ",", 
          RowBox[{"-", "rMax"}], ",", "rMax"}], "}"}], ",", 
        RowBox[{"StreamPoints", "\[Rule]", "Coarse"}], ",", 
        RowBox[{"StreamStyle", "\[Rule]", "Blue"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"cP", ",", "sP", ",", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"x", ",", "y"}], "}"}]}]}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6742816684469223`*^9, 3.674281704035302*^9}, {
  3.674469667256364*^9, 3.674469724299103*^9}, {3.674469916050662*^9, 
  3.6744699210995893`*^9}, {3.674470019012755*^9, 3.6744700209588547`*^9}, {
  3.674471129324291*^9, 3.674471131558484*^9}, {3.67447244409823*^9, 
  3.674472446963429*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "=", "5"}], ";"}]], "Input",
 CellChangeTimes->{{3.674472501015851*^9, 3.67447250461211*^9}, 
   3.674472767652882*^9, {3.674473192148897*^9, 3.674473193038767*^9}, 
   3.67447482400314*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"plotYZEn5", "=", 
   RowBox[{"PlotYZEfield", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotYZBn5", "=", 
   RowBox[{"PlotYZBfield", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotXYEn5", "=", 
   RowBox[{"PlotXYEfield", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotXYBn5", "=", 
   RowBox[{"PlotXYBfield", "[", "n", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6742817049273577`*^9, 3.67428170792157*^9}, 
   3.674470185950386*^9, {3.674470487628278*^9, 3.674470491266467*^9}, {
   3.67447245145706*^9, 3.674472451779586*^9}, {3.6744724890335608`*^9, 
   3.6744724894699173`*^9}, {3.67447484445398*^9, 3.674474848285685*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.674472507676865*^9, 3.6744727695143538`*^9, 
  3.674473194843328*^9, 3.674473405771597*^9, 3.6744749269187183`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.674472507676865*^9, 3.6744727695143538`*^9, 
  3.674473194843328*^9, 3.674473405771597*^9, 3.6744749269281*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.674472507676865*^9, 3.6744727695143538`*^9, 
  3.674473194843328*^9, 3.674473405771597*^9, 3.674474926977174*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Infinity \
:: indet\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.674472507676865*^9, 3.6744727695143538`*^9, 
  3.674473194843328*^9, 3.674473405771597*^9, 3.674474927001422*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotsn5", "=", 
   RowBox[{"GraphicsGrid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"plotYZEn5", ",", "plotYZBn5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"plotXYEn5", ",", "plotXYBn5"}], "}"}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "50"}], ",", 
        RowBox[{"-", "100"}]}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"\"\<V=\>\"", "<>", 
       RowBox[{"ToString", "[", "V", "]"}], "<>", "\"\<, w=\>\"", "<>", 
       RowBox[{"ToString", "[", "w", "]"}], "<>", "\"\<, rh=\>\"", "<>", 
       RowBox[{"ToString", "[", "rh", "]"}]}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6744701321488047`*^9, 3.6744701546393948`*^9}, {
   3.674470189844223*^9, 3.6744701954748573`*^9}, {3.674470399359757*^9, 
   3.6744704139463253`*^9}, {3.674470496580331*^9, 3.674470512252656*^9}, {
   3.674470723613237*^9, 3.674470736079023*^9}, {3.674470802246767*^9, 
   3.674470850302024*^9}, 3.674471233719697*^9, 3.674471851019773*^9, {
   3.674474852008754*^9, 3.674474859362712*^9}, 3.67447573702925*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"\"\<HBH-EM-fields-n=5.pdf\>\"", ",", "plotsn5"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.674475074340846*^9, 3.674475083939732*^9}, 
   3.674475145703042*^9, {3.6744757589070168`*^9, 3.674475761934276*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "=", "50"}], ";"}]], "Input",
 CellChangeTimes->{{3.674474880131301*^9, 3.674474881834035*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"plotYZEn50", "=", 
   RowBox[{"PlotYZEfield", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotYZBn50", "=", 
   RowBox[{"PlotYZBfield", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotXYEn50", "=", 
   RowBox[{"PlotXYEfield", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotXYBn50", "=", 
   RowBox[{"PlotXYBfield", "[", "n", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.674474877162644*^9, 3.674474885413834*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\\\ ComplexInfinity\\)\[NoBreak] encountered. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/indet\\\", \
ButtonNote -> \\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.674475230814601*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.674475230861723*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\\\ ComplexInfinity\\)\[NoBreak] encountered. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/indet\\\", \
ButtonNote -> \\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.674475230913588*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Infinity \
:: indet\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.674475230951573*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotsn50", "=", 
   RowBox[{"GraphicsGrid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"plotYZEn50", ",", "plotYZBn50"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"plotXYEn50", ",", "plotXYBn50"}], "}"}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "50"}], ",", 
        RowBox[{"-", "100"}]}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"\"\<V=\>\"", "<>", 
       RowBox[{"ToString", "[", "V", "]"}], "<>", "\"\<, w=\>\"", "<>", 
       RowBox[{"ToString", "[", "w", "]"}], "<>", "\"\<, rh=\>\"", "<>", 
       RowBox[{"ToString", "[", "rh", "]"}]}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.674474886395602*^9, 3.674474905092021*^9}, 
   3.674475733436654*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<HBH-EM-fields-n=50.pdf\>\"", ",", "plotsn50"}], "]"}]], "Input",\

 CellChangeTimes->{{3.674475160400222*^9, 3.674475169971834*^9}, {
  3.674475750067811*^9, 3.674475753395069*^9}}],

Cell[BoxData["\<\"HBH-EM-fields-n=50.pdf\"\>"], "Output",
 CellChangeTimes->{3.674475784610688*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", "=", "150"}], ";"}]], "Input",
 CellChangeTimes->{{3.674474908812949*^9, 3.674474915411847*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"plotYZEn150", "=", 
   RowBox[{"PlotYZEfield", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotYZBn150", "=", 
   RowBox[{"PlotYZBfield", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotXYEn150", "=", 
   RowBox[{"PlotXYEfield", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plotXYBn150", "=", 
   RowBox[{"PlotXYBfield", "[", "n", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.674474908812949*^9, 3.674474918501369*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\\\ ComplexInfinity\\)\[NoBreak] encountered. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/indet\\\", \
ButtonNote -> \\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6744754990399942`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\)\[NoBreak] encountered. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/indet\\\", ButtonNote -> \
\\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6744754990840054`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Infinity", "::", "indet"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Indeterminate expression \[NoBreak]\\!\\(0.`\\\\ \
ComplexInfinity\\\\ ComplexInfinity\\)\[NoBreak] encountered. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/indet\\\", \
ButtonNote -> \\\"Infinity::indet\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.674475499131806*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(Infinity \
:: indet\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.6744754991548986`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotsn150", "=", 
   RowBox[{"GraphicsGrid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"plotYZEn150", ",", "plotYZBn150"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"plotXYEn150", ",", "plotXYBn150"}], "}"}]}], "}"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "600"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "50"}], ",", 
        RowBox[{"-", "100"}]}], "}"}]}], ",", 
     RowBox[{"PlotLabel", "\[Rule]", 
      RowBox[{"\"\<V=\>\"", "<>", 
       RowBox[{"ToString", "[", "V", "]"}], "<>", "\"\<, w=\>\"", "<>", 
       RowBox[{"ToString", "[", "w", "]"}], "<>", "\"\<, rh=\>\"", "<>", 
       RowBox[{"ToString", "[", "rh", "]"}]}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.674474908812949*^9, 3.674474928032984*^9}, 
   3.674475723047801*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<HBH-EM-fields-n=150.pdf\>\"", ",", "plotsn150"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.674475430894782*^9, 3.674475433848406*^9}, {
  3.674475742216028*^9, 3.674475745820601*^9}}],

Cell[BoxData["\<\"HBH-EM-fields-n=150.pdf\"\>"], "Output",
 CellChangeTimes->{3.6744756471886873`*^9, 3.674475789227416*^9}]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 434, 12, 111, "Input"],
Cell[995, 34, 224, 6, 35, "Input"],
Cell[1222, 42, 139, 1, 35, "Text"],
Cell[CellGroupData[{
Cell[1386, 47, 3139, 88, 248, "Input"],
Cell[4528, 137, 2660, 48, 97, "Output"],
Cell[7191, 187, 4861, 111, 142, "Output"]
}, Open  ]],
Cell[12067, 301, 162, 2, 35, "Text"],
Cell[12232, 305, 265, 7, 61, "Input"],
Cell[12500, 314, 998, 31, 61, "Input"],
Cell[13501, 347, 205, 5, 35, "Input"],
Cell[13709, 354, 136, 1, 35, "Text"],
Cell[13848, 357, 562, 15, 35, "Input"],
Cell[14413, 374, 3515, 106, 336, "Input"],
Cell[17931, 482, 498, 15, 35, "Input"],
Cell[18432, 499, 497, 15, 35, "Input"],
Cell[CellGroupData[{
Cell[18954, 518, 184, 3, 35, "Input"],
Cell[19141, 523, 5297, 128, 219, "Output"]
}, Open  ]],
Cell[24453, 654, 163, 3, 35, "Text"],
Cell[CellGroupData[{
Cell[24641, 661, 1474, 32, 89, "Input"],
Cell[26118, 695, 3257, 66, 112, "Output"]
}, Open  ]],
Cell[29390, 764, 1827, 42, 86, "Input"],
Cell[31220, 808, 2178, 49, 86, "Input"],
Cell[33401, 859, 193, 4, 35, "Input"],
Cell[33597, 865, 815, 23, 35, "Input"],
Cell[34415, 890, 470, 14, 35, "Input"],
Cell[34888, 906, 693, 16, 87, "Input"],
Cell[35584, 924, 159, 3, 35, "Text"],
Cell[35746, 929, 954, 29, 136, "Input"],
Cell[36703, 960, 1440, 40, 136, "Input"],
Cell[38146, 1002, 738, 18, 37, "Input"],
Cell[38887, 1022, 7846, 253, 186, "Input"],
Cell[46736, 1277, 1977, 57, 186, "Input"],
Cell[48716, 1336, 659, 17, 186, "Input"],
Cell[49378, 1355, 209, 4, 35, "Text"],
Cell[49590, 1361, 1163, 29, 111, "Input"],
Cell[50756, 1392, 2164, 65, 86, "Input"],
Cell[52923, 1459, 2164, 65, 86, "Input"],
Cell[CellGroupData[{
Cell[55112, 1528, 581, 17, 86, "Input"],
Cell[55696, 1547, 1736, 51, 64, "Output"]
}, Open  ]],
Cell[57447, 1601, 10945, 272, 636, "Input"],
Cell[68395, 1875, 10819, 271, 636, "Input"],
Cell[79217, 2148, 8513, 220, 436, "Input"],
Cell[87733, 2370, 8516, 220, 436, "Input"],
Cell[96252, 2592, 229, 5, 35, "Input"],
Cell[CellGroupData[{
Cell[96506, 2601, 752, 16, 111, "Input"],
Cell[97261, 2619, 572, 11, 23, "Message"],
Cell[97836, 2632, 568, 11, 23, "Message"],
Cell[98407, 2645, 570, 11, 23, "Message"],
Cell[98980, 2658, 625, 12, 23, "Message"]
}, Open  ]],
Cell[99620, 2673, 1244, 27, 61, "Input"],
Cell[100867, 2702, 278, 6, 35, "Input"],
Cell[101148, 2710, 134, 3, 35, "Input"],
Cell[CellGroupData[{
Cell[101307, 2717, 535, 13, 111, "Input"],
Cell[101845, 2732, 497, 10, 23, "Message"],
Cell[102345, 2744, 477, 10, 23, "Message"],
Cell[102825, 2756, 497, 10, 23, "Message"],
Cell[103325, 2768, 532, 11, 23, "Message"]
}, Open  ]],
Cell[103872, 2782, 906, 23, 61, "Input"],
Cell[CellGroupData[{
Cell[104803, 2809, 235, 5, 35, "Input"],
Cell[105041, 2816, 99, 1, 33, "Output"]
}, Open  ]],
Cell[105155, 2820, 135, 3, 35, "Input"],
Cell[CellGroupData[{
Cell[105315, 2827, 539, 13, 111, "Input"],
Cell[105857, 2842, 499, 10, 23, "Message"],
Cell[106359, 2854, 479, 10, 23, "Message"],
Cell[106841, 2866, 497, 10, 23, "Message"],
Cell[107341, 2878, 534, 11, 23, "Message"]
}, Open  ]],
Cell[107890, 2892, 911, 23, 61, "Input"],
Cell[CellGroupData[{
Cell[108826, 2919, 238, 5, 35, "Input"],
Cell[109067, 2926, 124, 1, 33, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
